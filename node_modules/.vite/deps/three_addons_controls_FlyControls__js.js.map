{
  "version": 3,
  "sources": ["../../three/examples/jsm/controls/FlyControls.js"],
  "sourcesContent": ["import {\r\n\tEventDispatcher,\r\n\tQuaternion,\r\n\tVector3\r\n} from 'three';\r\n\r\nconst _changeEvent = { type: 'change' };\r\n\r\nclass FlyControls extends EventDispatcher {\r\n\r\n\tconstructor( object, domElement ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.domElement = domElement;\r\n\r\n\t\t// API\r\n\r\n\t\tthis.movementSpeed = 1.0;\r\n\t\tthis.rollSpeed = 0.005;\r\n\r\n\t\tthis.dragToLook = false;\r\n\t\tthis.autoForward = false;\r\n\r\n\t\t// disable default target object behavior\r\n\r\n\t\t// internals\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\tconst EPS = 0.000001;\r\n\r\n\t\tconst lastQuaternion = new Quaternion();\r\n\t\tconst lastPosition = new Vector3();\r\n\r\n\t\tthis.tmpQuaternion = new Quaternion();\r\n\r\n\t\tthis.status = 0;\r\n\r\n\t\tthis.moveState = { up: 0, down: 0, left: 0, right: 0, forward: 0, back: 0, pitchUp: 0, pitchDown: 0, yawLeft: 0, yawRight: 0, rollLeft: 0, rollRight: 0 };\r\n\t\tthis.moveVector = new Vector3( 0, 0, 0 );\r\n\t\tthis.rotationVector = new Vector3( 0, 0, 0 );\r\n\r\n\t\tthis.keydown = function ( event ) {\r\n\r\n\t\t\tif ( event.altKey ) {\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( event.code ) {\r\n\r\n\t\t\t\tcase 'ShiftLeft':\r\n\t\t\t\tcase 'ShiftRight': this.movementSpeedMultiplier = .1; break;\r\n\r\n\t\t\t\tcase 'KeyW': this.moveState.forward = 1; break;\r\n\t\t\t\tcase 'KeyS': this.moveState.back = 1; break;\r\n\r\n\t\t\t\tcase 'KeyA': this.moveState.left = 1; break;\r\n\t\t\t\tcase 'KeyD': this.moveState.right = 1; break;\r\n\r\n\t\t\t\tcase 'KeyR': this.moveState.up = 1; break;\r\n\t\t\t\tcase 'KeyF': this.moveState.down = 1; break;\r\n\r\n\t\t\t\tcase 'ArrowUp': this.moveState.pitchUp = 1; break;\r\n\t\t\t\tcase 'ArrowDown': this.moveState.pitchDown = 1; break;\r\n\r\n\t\t\t\tcase 'ArrowLeft': this.moveState.yawLeft = 1; break;\r\n\t\t\t\tcase 'ArrowRight': this.moveState.yawRight = 1; break;\r\n\r\n\t\t\t\tcase 'KeyQ': this.moveState.rollLeft = 1; break;\r\n\t\t\t\tcase 'KeyE': this.moveState.rollRight = 1; break;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateMovementVector();\r\n\t\t\tthis.updateRotationVector();\r\n\r\n\t\t};\r\n\r\n\t\tthis.keyup = function ( event ) {\r\n\r\n\t\t\tswitch ( event.code ) {\r\n\r\n\t\t\t\tcase 'ShiftLeft':\r\n\t\t\t\tcase 'ShiftRight': this.movementSpeedMultiplier = 1; break;\r\n\r\n\t\t\t\tcase 'KeyW': this.moveState.forward = 0; break;\r\n\t\t\t\tcase 'KeyS': this.moveState.back = 0; break;\r\n\r\n\t\t\t\tcase 'KeyA': this.moveState.left = 0; break;\r\n\t\t\t\tcase 'KeyD': this.moveState.right = 0; break;\r\n\r\n\t\t\t\tcase 'KeyR': this.moveState.up = 0; break;\r\n\t\t\t\tcase 'KeyF': this.moveState.down = 0; break;\r\n\r\n\t\t\t\tcase 'ArrowUp': this.moveState.pitchUp = 0; break;\r\n\t\t\t\tcase 'ArrowDown': this.moveState.pitchDown = 0; break;\r\n\r\n\t\t\t\tcase 'ArrowLeft': this.moveState.yawLeft = 0; break;\r\n\t\t\t\tcase 'ArrowRight': this.moveState.yawRight = 0; break;\r\n\r\n\t\t\t\tcase 'KeyQ': this.moveState.rollLeft = 0; break;\r\n\t\t\t\tcase 'KeyE': this.moveState.rollRight = 0; break;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateMovementVector();\r\n\t\t\tthis.updateRotationVector();\r\n\r\n\t\t};\r\n\r\n\t\tthis.pointerdown = function ( event ) {\r\n\r\n\t\t\tif ( this.dragToLook ) {\r\n\r\n\t\t\t\tthis.status ++;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tswitch ( event.button ) {\r\n\r\n\t\t\t\t\tcase 0: this.moveState.forward = 1; break;\r\n\t\t\t\t\tcase 2: this.moveState.back = 1; break;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.updateMovementVector();\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.pointermove = function ( event ) {\r\n\r\n\t\t\tif ( ! this.dragToLook || this.status > 0 ) {\r\n\r\n\t\t\t\tconst container = this.getContainerDimensions();\r\n\t\t\t\tconst halfWidth = container.size[ 0 ] / 2;\r\n\t\t\t\tconst halfHeight = container.size[ 1 ] / 2;\r\n\r\n\t\t\t\tthis.moveState.yawLeft = - ( ( event.pageX - container.offset[ 0 ] ) - halfWidth ) / halfWidth;\r\n\t\t\t\tthis.moveState.pitchDown = ( ( event.pageY - container.offset[ 1 ] ) - halfHeight ) / halfHeight;\r\n\r\n\t\t\t\tthis.updateRotationVector();\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.pointerup = function ( event ) {\r\n\r\n\t\t\tif ( this.dragToLook ) {\r\n\r\n\t\t\t\tthis.status --;\r\n\r\n\t\t\t\tthis.moveState.yawLeft = this.moveState.pitchDown = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tswitch ( event.button ) {\r\n\r\n\t\t\t\t\tcase 0: this.moveState.forward = 0; break;\r\n\t\t\t\t\tcase 2: this.moveState.back = 0; break;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.updateMovementVector();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateRotationVector();\r\n\r\n\t\t};\r\n\r\n\t\tthis.update = function ( delta ) {\r\n\r\n\t\t\tconst moveMult = delta * scope.movementSpeed;\r\n\t\t\tconst rotMult = delta * scope.rollSpeed;\r\n\r\n\t\t\tscope.object.translateX( scope.moveVector.x * moveMult );\r\n\t\t\tscope.object.translateY( scope.moveVector.y * moveMult );\r\n\t\t\tscope.object.translateZ( scope.moveVector.z * moveMult );\r\n\r\n\t\t\tscope.tmpQuaternion.set( scope.rotationVector.x * rotMult, scope.rotationVector.y * rotMult, scope.rotationVector.z * rotMult, 1 ).normalize();\r\n\t\t\tscope.object.quaternion.multiply( scope.tmpQuaternion );\r\n\r\n\t\t\tif (\r\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\r\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS\r\n\t\t\t) {\r\n\r\n\t\t\t\tscope.dispatchEvent( _changeEvent );\r\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\r\n\t\t\t\tlastPosition.copy( scope.object.position );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.updateMovementVector = function () {\r\n\r\n\t\t\tconst forward = ( this.moveState.forward || ( this.autoForward && ! this.moveState.back ) ) ? 1 : 0;\r\n\r\n\t\t\tthis.moveVector.x = ( - this.moveState.left + this.moveState.right );\r\n\t\t\tthis.moveVector.y = ( - this.moveState.down + this.moveState.up );\r\n\t\t\tthis.moveVector.z = ( - forward + this.moveState.back );\r\n\r\n\t\t\t//console.log( 'move:', [ this.moveVector.x, this.moveVector.y, this.moveVector.z ] );\r\n\r\n\t\t};\r\n\r\n\t\tthis.updateRotationVector = function () {\r\n\r\n\t\t\tthis.rotationVector.x = ( - this.moveState.pitchDown + this.moveState.pitchUp );\r\n\t\t\tthis.rotationVector.y = ( - this.moveState.yawRight + this.moveState.yawLeft );\r\n\t\t\tthis.rotationVector.z = ( - this.moveState.rollRight + this.moveState.rollLeft );\r\n\r\n\t\t\t//console.log( 'rotate:', [ this.rotationVector.x, this.rotationVector.y, this.rotationVector.z ] );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getContainerDimensions = function () {\r\n\r\n\t\t\tif ( this.domElement != document ) {\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tsize: [ this.domElement.offsetWidth, this.domElement.offsetHeight ],\r\n\t\t\t\t\toffset: [ this.domElement.offsetLeft, this.domElement.offsetTop ]\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tsize: [ window.innerWidth, window.innerHeight ],\r\n\t\t\t\t\toffset: [ 0, 0 ]\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.dispose = function () {\r\n\r\n\t\t\tthis.domElement.removeEventListener( 'contextmenu', contextmenu );\r\n\t\t\tthis.domElement.removeEventListener( 'pointerdown', _pointerdown );\r\n\t\t\tthis.domElement.removeEventListener( 'pointermove', _pointermove );\r\n\t\t\tthis.domElement.removeEventListener( 'pointerup', _pointerup );\r\n\r\n\t\t\twindow.removeEventListener( 'keydown', _keydown );\r\n\t\t\twindow.removeEventListener( 'keyup', _keyup );\r\n\r\n\t\t};\r\n\r\n\t\tconst _pointermove = this.pointermove.bind( this );\r\n\t\tconst _pointerdown = this.pointerdown.bind( this );\r\n\t\tconst _pointerup = this.pointerup.bind( this );\r\n\t\tconst _keydown = this.keydown.bind( this );\r\n\t\tconst _keyup = this.keyup.bind( this );\r\n\r\n\t\tthis.domElement.addEventListener( 'contextmenu', contextmenu );\r\n\t\tthis.domElement.addEventListener( 'pointerdown', _pointerdown );\r\n\t\tthis.domElement.addEventListener( 'pointermove', _pointermove );\r\n\t\tthis.domElement.addEventListener( 'pointerup', _pointerup );\r\n\r\n\t\twindow.addEventListener( 'keydown', _keydown );\r\n\t\twindow.addEventListener( 'keyup', _keyup );\r\n\r\n\t\tthis.updateMovementVector();\r\n\t\tthis.updateRotationVector();\r\n\r\n\t}\r\n\r\n}\r\n\r\nfunction contextmenu( event ) {\r\n\r\n\tevent.preventDefault();\r\n\r\n}\r\n\r\nexport { FlyControls };\r\n"],
  "mappings": "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",
  "names": []
}
